---
/**
 * CategoryGrid1 Component (Organism)
 *
 * Displays a grid of categories using CategoryCard1 components.
 * Ideal for category listing pages or sidebar navigation.
 *
 * Naming: CategoryGrid1 follows Relume naming convention.
 * - CategoryGrid1: Grid layout for categories (this component)
 *
 * @example
 * <CategoryGrid1
 *   title="Categories"
 *   subtitle="Browse posts by topic"
 *   categories={categories}
 * />
 *
 * @customization
 * Override these CSS variables to customize:
 * --categorygrid1-gap, --categorygrid1-card-*
 */

import Section from './Section.astro';
import CategoryCard1 from '@molecules/CategoryCard1.astro';

interface Category {
  /** Category slug for URL */
  slug: string;
  /** Category data */
  data: {
    name: string;
    description?: string;
    color?: string;
  };
  /** Number of posts in this category */
  postCount?: number;
}

interface Props {
  /** Section title */
  title?: string;
  /** Section subtitle */
  subtitle?: string;
  /** Array of categories to display */
  categories: Category[];
  /** Number of columns (2 or 3) */
  columns?: 2 | 3;
  /** Card style variant */
  cardVariant?: 'elevated' | 'outlined' | 'filled';
  /** Section size (vertical padding) */
  size?: 'sm' | 'md' | 'lg';
  /** Override top padding */
  paddingTop?: 'none' | 'sm' | 'md' | 'lg';
  /** Override bottom padding */
  paddingBottom?: 'none' | 'sm' | 'md' | 'lg';
  /** Background variant */
  background?: 'default' | 'muted' | 'primary' | 'dark';
  /** Center the section heading */
  centerHeading?: boolean;
  /** Base URL for categories */
  baseUrl?: string;
  /** Additional CSS classes */
  class?: string;
  [key: string]: any;
}

const {
  title,
  subtitle,
  categories,
  columns = 2,
  cardVariant = 'outlined',
  size = 'md',
  paddingTop,
  paddingBottom,
  background = 'default',
  centerHeading = false,
  baseUrl = '/category',
  class: className = '',
  ...rest
} = Astro.props;

// Build padding classes
const paddingClasses = [
  paddingTop && `padding-top-${paddingTop}`,
  paddingBottom && `padding-bottom-${paddingBottom}`,
].filter(Boolean).join(' ');

const gridClass = [
  'categorygrid1_grid',
  `categorygrid1_grid--cols-${columns}`,
].join(' ');

const sectionClasses = [
  'categorygrid1',
  paddingClasses,
  className,
].filter(Boolean).join(' ');
---

<Section 
  title={title}
  subtitle={subtitle}
  size={size} 
  background={background}
  centerHeading={centerHeading}
  class={sectionClasses}
  {...rest}
>
  {categories.length > 0 ? (
    <div class={gridClass}>
      {categories.map((category) => (
        <CategoryCard1
          name={category.data.name}
          description={category.data.description}
          href={`${baseUrl}/${category.slug}`}
          postCount={category.postCount}
          color={category.data.color}
          variant={cardVariant}
        />
      ))}
    </div>
  ) : (
    <p class="categorygrid1_empty">No categories found.</p>
  )}
  
  <!-- Slot for additional content -->
  <slot />
</Section>

<style>
  /* Padding override classes */
  .padding-top-none { padding-top: 0 !important; }
  .padding-top-sm { padding-top: var(--padding-section-small) !important; }
  .padding-top-md { padding-top: var(--padding-section-medium) !important; }
  .padding-top-lg { padding-top: var(--padding-section-large) !important; }
  
  .padding-bottom-none { padding-bottom: 0 !important; }
  .padding-bottom-sm { padding-bottom: var(--padding-section-small) !important; }
  .padding-bottom-md { padding-bottom: var(--padding-section-medium) !important; }
  .padding-bottom-lg { padding-bottom: var(--padding-section-large) !important; }

  .categorygrid1_grid {
    display: grid;
    gap: var(--categorygrid1-gap, var(--space-6));
  }

  .categorygrid1_grid--cols-2 {
    grid-template-columns: repeat(1, 1fr);
  }

  .categorygrid1_grid--cols-3 {
    grid-template-columns: repeat(1, 1fr);
  }

  @media (min-width: 640px) {
    .categorygrid1_grid--cols-2,
    .categorygrid1_grid--cols-3 {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .categorygrid1_grid--cols-3 {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  .categorygrid1_empty {
    text-align: center;
    color: var(--color-text-secondary);
    padding: var(--space-12) 0;
  }
</style>
